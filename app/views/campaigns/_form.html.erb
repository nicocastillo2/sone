<%= form_for(@campaign, html: { class: "form-horizontal", role: "form" }) do |f| %>
  <% if @campaign.errors.any? %>
    <div class="alert alert-danger alert-dismissable" role="alert">
      <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
      <h4><%= pluralize(@campaign.errors.count, "error") %> prohibited this campaign from being saved:</h4>

      <ul>
      <% @campaign.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>
  <div class="row">
    <div class="col-md-4">
    <h3 class="pink titulo"><span class="glyphicon glyphicon-plus circle"></span> Crear Campaña</h3>
    <br>
      <div class="form-group">
        <div class="col-sm-10">
          <%= f.text_field :name, class: "form-control form-pink", placeholder:"Nombre de la campaña" %>
        </div>
      </div>
      <div class="form-group">
        <div class="col-sm-10">
          <%= f.text_field :sender_name, class: "form-control form-pink", placeholder:"Nombre del remitente" %>
        </div>
      </div>
      <div class="form-group">
        <div class="col-sm-10">
          <%= f.text_field :sender_email, class: "form-control form-pink", placeholder:"Email del remitente" %>
        </div>
      </div>
      <div class="form-group">
        <div class="col-sm-10">
          <%= f.text_field :color, input_html: {data: {minicolors: {theme: :bootstrap}}}, as: :minicolors, placeholder:"Color",class: "form-control colorpicker form-pink" %>
        </div>
      </div>
      <div class="form-group text-center">
        <div class="col-sm-10">
          <%= f.file_field :logo, placeholder: 'Sin Archivo', class: 'inputfile' %>
          <%= f.label :logo, 'Subir Logo' , class: "control-label" do %>
            <figure><svg xmlns="http://www.w3.org/2000/svg" width="20" height="17" viewBox="0 0 20 17"><path d="M10 0l-5.2 4.9h3.3v5.1h3.8v-5.1h3.3l-5.2-4.9zm9.3 11.5l-3.2-2.1h-2l3.4 2.6h-3.5c-.1 0-.2.1-.2.1l-.8 2.3h-6l-.8-2.2c-.1-.1-.1-.2-.2-.2h-3.6l3.4-2.6h-2l-3.2 2.1c-.4.3-.7 1-.6 1.5l.6 3.1c.1.5.7.9 1.2.9h16.3c.6 0 1.1-.4 1.3-.9l.6-3.1c.1-.5-.2-1.2-.7-1.5z"/></svg></figure> <span>Subir logo&hellip;</span>
          <% end %>
        </div>
      </div>

      <%= image_tag("cel.png", class: "img-responsive img-center") %>
    </div>
    <div class="col-md-4">
      <h3 class="pink text-center">Vista previa</h3>
      <%= image_tag("iphone.png", class: "img-responsive img-center") %>

    </div>
    <div class="col-md-4">
      <div class="form-group">
      <h4 class="pink titulo"><span class="glyphicon glyphicon-plus circle"></span> Añade topics a tu campaña</h4>
      <p class="gray">Los topics son atributos (información que acompañan a las direcciones de correo de tus clientes). Al incluirlos, el diagnóstico sobre la experiencia que tu marca ofrece será más completo.</p>
        <%= f.label :tmp_topics, 'Topics', class: "col-sm-2 control-label text-gray-form" %>
        <div class="col-sm-10">
          <ul class="gray">
          <% Campaign.contact_topics.each do |t_spanish, t_english| %>
            <%= f.check_box :topics, { multiple: true, class: "" }, t_english, nil %>
            <%= t_spanish.camelize %>
            <br>
          <% end %>
          </ul>
        </div>
        <div class="form-group">
          <div class="col-sm-offset-1 col-sm-5">
            <%= f.submit "Crear", class: "btn btn-default send-button button-100" %>
          </div>
          <div class="col-sm-offset-1 col-sm-5 ">
            <%= link_to(campaigns_path, class: 'btn btn-default send-button button-100') do %>
              Salir
            <% end %>
          </div>
        </div>
      </div>
    </div>

  </div>

<% end %>

<script type="text/javascript">
  ;( function ( document, window, index )
  {
  var inputs = document.querySelectorAll( '.inputfile' );
  Array.prototype.forEach.call( inputs, function( input )
  {
    var label	 = input.nextElementSibling,
      labelVal = label.innerHTML;

    input.addEventListener( 'change', function( e )
    {
      var fileName = '';
      if( this.files && this.files.length > 1 )
        fileName = ( this.getAttribute( 'data-multiple-caption' ) || '' ).replace( '{count}', this.files.length );
      else
        fileName = e.target.value.split( '\\' ).pop();

      if( fileName )
        label.querySelector( 'span' ).innerHTML = fileName;
      else
        label.innerHTML = labelVal;
    });

    // Firefox bug fix
    input.addEventListener( 'focus', function(){ input.classList.add( 'has-focus' ); });
    input.addEventListener( 'blur', function(){ input.classList.remove( 'has-focus' ); });
  });
  }( document, window, 0 ));
</script>
